import("gpio");
import("timer");

fun flash(seconds) {
    gpio_init(pico_led);
    gpio_set_direction(pico_led, true);

    var state = false;

    fun toggle() {
        state = !state;
        gpio_put(pico_led, state);
    }

    var done = make_channel();
    fun complete() {
        share(done, true);
    }

    repeating_alarm_ms(0d0, 500, toggle);
    alarm_in_ms(0d1, uint32(seconds) * 0d1000, complete); 
    receive(done); 
    cancel_repeating_alarm(0d0); 
}